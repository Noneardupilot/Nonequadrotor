/******************************************************************************************************************
**头文件说明 ： 任务调度文件配置
**时      间 ： 2018-4-30
**作      者 ： 历小伟
**联系 方式  ： 15982962929
**备      注 ：
******************************************************************************************************************/


/*=============================================================================================================
                                         头文件START
==============================================================================================================*/
#include "scheduler.h"
#include "copter.h"


/*=============================================================================================================
                                         头文件START
==============================================================================================================*/
SCHEDULER::System_loop_time LoopTime ;   //系统循环运行时间结构题定义

SCHEDULER Scheduler;
/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Schedule(void)
{
  if( LoopTime.check_flag == 1 )
	{
     //1ms
		if(LoopTime.cnt_1ms>=1)
		{
			LoopTime.cnt_1ms=0;
		  Loop_Task_1ms();
		}
		//2ms
	   if(LoopTime.cnt_2ms>=2)
		{
			LoopTime.cnt_2ms=0;
			Loop_Task_2ms();
		}

		//5ms
		 if(LoopTime.cnt_5ms>=5)
		{
			LoopTime.cnt_5ms=0;
			Loop_Task_5ms();
		}
		//10ms
		 if(LoopTime.cnt_10ms>=10)
		{
			LoopTime.cnt_10ms=0;
			Loop_Task_10ms();
		}
			//20ms
		 if(LoopTime.cnt_20ms>=20)
		{
			LoopTime.cnt_20ms=0;
			Loop_Task_20ms();
		}
			//25ms
		 if(LoopTime.cnt_25ms>=25)
		{
			LoopTime.cnt_25ms=0;
			Loop_Task_25ms();
		}
		
		
			//50ms
		 if(LoopTime.cnt_50ms>=50)
		{
			LoopTime.cnt_50ms=0;
			Loop_Task_50ms();
		}
		if(LoopTime.cnt_80ms>=80)
		{
			LoopTime.cnt_80ms=0;
			Loop_Task_80ms();
		}
		if(LoopTime.cnt_90ms>=90)
		{
			LoopTime.cnt_90ms=0;
			Loop_Task_90ms();
		}
		//100ms
		 if(LoopTime.cnt_100ms>=100)
		{
			LoopTime.cnt_100ms=0;
			Loop_Task_100ms();
		}
	  LoopTime.check_flag = 0;		//
	}


}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_1ms(void)
{


}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_2ms(void)
{


}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_4ms(void)
{


}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_5ms(void)
{

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_10ms(void)
{

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_20ms(void)
{

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_25ms(void)
{

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_50ms(void)
{

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_80ms(void)
{

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_90ms(void)
{

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_100ms(void)
{


}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_Task_Trigger_Start(void)
{
  	if(time_1ms < 999) //小于1s
	{
    time_1ms++;
    
		Loop_check();
	}
	else    //大于1s
	{
		
    time_1ms =0;
	  if(time_1s<59)  //小于1分钟
	  {
      time_1s++;
		}
		else  //大于1分钟
		{
			time_1s = 0;
			if(time_1m<59)  //小于60分钟
			{
				time_1m++;
			}
			else       //大于60分钟
			{
				time_1m = 0;
				if(time_1h<23)  //小于24h
				{
					time_1h++;
				}
				else          //大于24h
				{
					time_1h = 0;
				}
			}
		}
	}

}

/*==================================================================================================================*/
/*==================================================================================================================*
**函数原型 : void CONST_LED::init(void)
**功    能 : led 初始化函数
**输    入 : None
**输    出 : None
**备    注 : PE12---LED 
**           PA9----USB
**================================================================================================================*/
/*================================================================================================================*/
void  SCHEDULER::Loop_check(void)
{
   LoopTime.cnt_1ms++;    //1ms中断
	 LoopTime.cnt_2ms++;   //2ms中断
	 LoopTime.cnt_4ms++;   //2ms中断
   LoopTime.cnt_5ms++;  //5ms中断
	 LoopTime.cnt_10ms++;//10ms中断
	 LoopTime.cnt_20ms++;//20ms中断
	 LoopTime.cnt_25ms++;//25ms中断
	 LoopTime.cnt_50ms++;//50ms中断
	 LoopTime.cnt_80ms++;//80ms中断
	 LoopTime.cnt_90ms++;//90ms中断
	 LoopTime.cnt_100ms++;//50ms中断
    if( LoopTime.check_flag == 1)
	{
		LoopTime.err_flag ++;     //每累加一次，证明代码在预定的时间内没有跑完
	}
	else
	{	
		LoopTime.check_flag = 1;	//该标志位最后被清零
	}

}




/**********************************************************************************************************
*                                      file---end
**********************************************************************************************************/